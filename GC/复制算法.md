# 复制算法



### 基本的算法:

* 堆一分为2，其中一个用来进行内存分配，假设是From。另一个假设命名为To。
* 执行GC时，从根开始遍历将活动对象拷贝到To空间并更新引用关系
* 复制完成后交换From 和To指向的空间

~~~
|-----------------------------|-----------------------------
|							  |				
|	     from				  |			to 	
|-----------------------------|-----------------------------
~~~

重点是复制时更新引用关系

缺点：一半的空间不能被使用。

#### 深度优先复制

从roots(根)开始，将一个根引用的对象、直至所有间接被引用的对象被复制完成，然后从另一个根开始从夫上述操作，直到所有的根。跟图的深度优先遍历类似

#### 广度优先复制

从根开始，先将所有被根直接引用的对象复制到To空间，然后是第二层被间接引用的对象



#### 近似广度优先复制

### 多空间复制算法

多空间复制算法的思想是将堆分成N(N>2)份，整个空间使用复制算法+标记-清扫算法。多空间复制算法可以提升堆的利用率。

堆的划分如下图所示：

~~~
|------------|----------------|------------------|----------
|			 |			  	  |					 |
|	     to  |		from	  |	mark-sweep		 | mark-s
|------------|----------------|------------------|----------

复制完成后：
|------------|----------------|------------------|----------
|			 |			  	  |					 |
|	from     |		to		  |	mark-sweep		 | mark-s
|------------|----------------|------------------|----------

~~~

基本步骤:

* 使用复制算法将from空间的对象复制到to空间
* 其他空间使用标记-清扫算法
* 复制算法完成后，to = from, from = (to + 1) %N

