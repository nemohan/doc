# docker 部署失败

2019/8/14

#### 背景

最近的项目需要使用docker部署python版本的爬虫。爬虫项目使用了supervisor来管理进程，所以打算继续在容器内使用supervisor。

#### 问题

部署过程中发现容器启动之后马上就退出了，当然最初是由于爬虫代码修改之后有bug导致的。当所有bug都修复完之后，仍然会出现上面的情况。后来看到supervisor默认是在后台运行，于是猜测可能是因为在后台运行导致的。将supervisor改为前台运行后，问题解决了。

#####  <font color="red">如何解决python项目的三方依赖 </font>

python项目一般都会依赖一些三方包，在主机上可以使用virtualenv管理。但是部署容器时应该怎么解决呢？

1）每次构建镜像时下载三方包，安装到容器内。每次都下载增加了构建时长,当然为了避免这个问题可以制作一个已经安装了三方包的基础镜像。在基础镜像基础上执行构建。

2）在容器内使用virtualenv（尝试了，貌似不可行。暂时没找到原因)

